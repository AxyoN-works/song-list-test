<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ›²ã®ç™»éŒ²</title>
    <style>
	body {
    font-family: "Helvetica Neue", sans-serif;
    background-color: #ffffff;
    color: #2c3e50;
    margin: 0;
    padding: 20px;
    text-align: center;
}

.container {
    max-width: 600px;
    margin: 20px auto;
    background: #f9f9f9;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(44, 62, 80, 0.1);
    border: 2px solid #2c3e50;
    text-align: left;
}

h1 {
    text-align: center;
    color: #2c3e50;
}

label {
    font-weight: bold;
    display: block;
    margin-top: 15px;
    color: #2c3e50;
}

input[type="text"],
input[type="radio"],
input[type="checkbox"] {
    margin-top: 5px;
    margin-bottom: 10px;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 100%;
}

.checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.checkbox-group label {
    width: 48%;
    color: #2c3e50;
}

button {
    background-color: #2c3e50;
    color: white;
    padding: 12px;
    font-size: 16px;
    width: 100%;
    border: none;
    border-radius: 5px;
    margin-top: 20px;
    cursor: pointer;
}

button:hover {
    background-color: #1a242f;
}

#debugMessage {
    margin-top: 20px;
    font-weight: bold;
    color: #d35400; /* ç›®ç«‹ã¤ã‚ˆã†ã«ã‚ªãƒ¬ãƒ³ã‚¸ç³» */
}


    </style>
</head>
<body>
	
	<div style="text-align: right; margin: 20px;">
  <a href="index.html">
    <button style="background-color: #3498db; color: white; border: none; padding: 8px 14px; border-radius: 6px; cursor: pointer;">
      ãƒªã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¸
    </button>
  </a>
</div>
	
    <div class="container">
        <h1>æ›²ã®ç™»éŒ²</h1>

        <label>æ­Œæ‰‹å</label>
        <input type="text" id="artistInput">

        <label>æ­Œæ‰‹åãµã‚ŠãŒãªï¼ˆã²ã‚‰ãŒãªï¼‰</label>
        <input type="text" id="artistFuriganaInput">

        <label>æ›²å</label>
        <input type="text" id="songInput">

        <label>æ›²åãµã‚ŠãŒãªï¼ˆã²ã‚‰ãŒãªï¼‰</label>
        <input type="text" id="songFuriganaInput">

        <label>ã‚¸ãƒ£ãƒ³ãƒ«ã‚¿ã‚°ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
        <div class="checkbox-group">
            <label><input type="checkbox" value="ç”·æ€§ãƒœãƒ¼ã‚«ãƒ«"> ç”·æ€§ãƒœãƒ¼ã‚«ãƒ«</label>
            <label><input type="checkbox" value="å¥³æ€§ãƒœãƒ¼ã‚«ãƒ«"> å¥³æ€§ãƒœãƒ¼ã‚«ãƒ«</label>
            <label><input type="checkbox" value="ã‚¢ãƒ‹ãƒ¡"> ã‚¢ãƒ‹ãƒ¡</label>
            <label><input type="checkbox" value="ãƒ‰ãƒ©ãƒ"> ãƒ‰ãƒ©ãƒ</label>
            <label><input type="checkbox" value="æ˜ ç”»"> æ˜ ç”»</label>
            <label><input type="checkbox" value="ãƒãƒ©ãƒ¼ãƒ‰"> ãƒãƒ©ãƒ¼ãƒ‰</label>
            <label><input type="checkbox" value="ã‚¢ã‚²ã‚¢ã‚²"> ã‚¢ã‚²ã‚¢ã‚²</label>
            <label><input type="checkbox" value="ãƒ­ãƒƒã‚¯"> ãƒ­ãƒƒã‚¯</label>
            <label><input type="checkbox" value="ã‚¢ã‚¤ãƒ‰ãƒ«"> ã‚¢ã‚¤ãƒ‰ãƒ«</label>
            <label><input type="checkbox" value="ãƒœã‚«ãƒ­"> ãƒœã‚«ãƒ­</label>
            <label><input type="checkbox" value="ã‚ªãƒªã‚¸ãƒŠãƒ«"> ã‚ªãƒªã‚¸ãƒŠãƒ«</label>
        </div>

        <label>å¹´ä»£ã‚¿ã‚°ï¼ˆ1ã¤é¸æŠï¼‰</label>
        <div class="checkbox-group">
            <label><input type="radio" name="decade" value="1960å¹´ä»£"> 1960å¹´ä»£</label>
            <label><input type="radio" name="decade" value="1970å¹´ä»£"> 1970å¹´ä»£</label>
            <label><input type="radio" name="decade" value="1980å¹´ä»£"> 1980å¹´ä»£</label>
            <label><input type="radio" name="decade" value="1990å¹´ä»£"> 1990å¹´ä»£</label>
            <label><input type="radio" name="decade" value="2000å¹´ä»£"> 2000å¹´ä»£</label>
            <label><input type="radio" name="decade" value="2010å¹´ä»£"> 2010å¹´ä»£</label>
            <label><input type="radio" name="decade" value="2020å¹´ä»£"> 2020å¹´ä»£</label>
        </div>

        <button onclick="saveSong()">ä¿å­˜</button>
    </div>

	<button onclick="checkSavedData()">ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª</button>
	
<script>
	
function saveSong() {
    try {
        const artist = document.getElementById("artistInput").value.trim();
        const artistFurigana = document.getElementById("artistFuriganaInput").value.trim();
        const song = document.getElementById("songInput").value.trim();
        const songFurigana = document.getElementById("songFuriganaInput").value.trim();
        const genres = [...document.querySelectorAll(".checkbox-group input:checked")].map(cb => cb.value);
        const decade = document.querySelector('input[name="decade"]:checked')?.value || "";

        if (!artist || !artistFurigana || !song || !songFurigana) {
            throw new Error("ã™ã¹ã¦ã®å…¥åŠ›æ¬„ã‚’åŸ‹ã‚ã¦ãã ã•ã„ï¼");
        }

        let songList = JSON.parse(localStorage.getItem("songList")) || [];
        songList.push({ artist, artistFurigana, song, songFurigana, genres, decade });
        localStorage.setItem("songList", JSON.stringify(songList));

		
		// Firebase Firestore ã«ä¿å­˜
addDoc(collection(db, "songs"), {
    artist,
    artistFurigana,
    song,
    songFurigana,
    genres,
    decade
}).then(() => {
    console.log("Firebaseã«ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼");
}).catch((error) => {
    console.error("Firebaseä¿å­˜æ™‚ã®ã‚¨ãƒ©ãƒ¼:", error);
});

        // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢
        document.getElementById("artistInput").value = "";
        document.getElementById("artistFuriganaInput").value = "";
        document.getElementById("songInput").value = "";
        document.getElementById("songFuriganaInput").value = "";
        document.querySelectorAll(".checkbox-group input").forEach(cb => cb.checked = false);

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
        const debugMessage = document.getElementById("debugMessage");
        if (debugMessage) {
            debugMessage.innerText = "âœ… ãƒ‡ãƒ¼ã‚¿ãŒæ­£å¸¸ã«ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼";
        }

    } catch (error) {
        const debugMessage = document.getElementById("debugMessage");
        if (debugMessage) {
            debugMessage.innerText = "âŒ ã‚¨ãƒ©ãƒ¼: " + error.message;
        }
    }
}

function checkSavedData() {
    let data = localStorage.getItem("songList");
    const debugMessage = document.getElementById("debugMessage");
    if (debugMessage) {
        debugMessage.innerText = data ? "ğŸ“‚ ä¿å­˜ãƒ‡ãƒ¼ã‚¿: " + data : "âš ï¸ ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“";
    }
}

async function clearLocalStorage() {
    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å‰Šé™¤
    localStorage.clear();
    document.getElementById("debugMessage").innerText = "ğŸ—‘ï¸ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ";

    try {
        // Firebaseã®songsã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã™ã¹ã¦å‰Šé™¤
        const songsRef = collection(db, "songs");
        const snapshot = await getDocs(songsRef);

        const deletePromises = snapshot.docs.map((doc) => deleteDoc(doc.ref));
        await Promise.all(deletePromises);

        document.getElementById("debugMessage").innerText += "\nğŸ—‘ï¸ Firebaseã®ãƒ‡ãƒ¼ã‚¿ã‚‚å‰Šé™¤ã—ã¾ã—ãŸï¼";
    } catch (error) {
        console.error("Firebaseå‰Šé™¤ã‚¨ãƒ©ãƒ¼:", error);
        document.getElementById("debugMessage").innerText += "\nâŒ Firebaseå‰Šé™¤ã‚¨ãƒ©ãƒ¼: " + error.message;
    }
}


function checkSavedData() {
    const data = localStorage.getItem("songList");
    alert(data ? "ä¿å­˜ãƒ‡ãƒ¼ã‚¿:\n" + data : "âš ï¸ ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
}

</script>

<!-- Firebase SDKèª­ã¿è¾¼ã¿ï¼ˆheadå†…ã‹bodyæœ€ä¸‹éƒ¨ï¼‰ -->
<script type="module">
  // Firebase SDKã‚’èª­ã¿è¾¼ã¿
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";

  // Firebaseæ§‹æˆæƒ…å ±
  const firebaseConfig = {
    apiKey: "AIzaSyADnhEAakgkAWR7OxPdK1K95uYDrVbM0ro",
    authDomain: "songlist-axyon.firebaseapp.com",
    projectId: "songlist-axyon",
    storageBucket: "songlist-axyon.appspot.com",
    messagingSenderId: "1088637040793",
    appId: "1:1088637040793:web:c6fd53751988fe0d8b6008"
  };

  // FirebaseåˆæœŸåŒ–ã¨Firestoreå–å¾—
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä½¿ãˆã‚‹ã‚ˆã†ã«windowã«ç™»éŒ²
  window.db = db;
  window.addDoc = addDoc;
  window.collection = collection;
  
  import { getDocs, deleteDoc } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";
  
</script>


	<!-- debugMessageã®è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
<p id="debugMessage"></p>

<button onclick="clearLocalStorage()">ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤</button>

</body>
</html>